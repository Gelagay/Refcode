<html>
<head>
<style>
.canvas {
  width: 180px;
  background-color: #ccc;
  line-height: 10px;
  border-right: solid 1px #ccc;
  border-bottom: solid 1px #ccc;
}
.pixel {
  display: inline-block;
  width: 29px;
  height: 29px;
  border-top: solid 1px #ccc;
  border-left: solid 1px #ccc;
  background-color: #fff;
}
.colorPicker__HS {
    width: 100px;
    height: 100px;
    border: double 3px gray;
}
.colorPicker__L {
    width: 100px;
    margin: auto 3px;
    display: block;
}
.colorPicker__HS > div {
    width: 1px;
    height: 1px;
    float: left;
}
</style>
</head>
<body>
    <section class="blocks-container">
        <div class="canvas">
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
            <div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div><div class="pixel"></div>
        </div>
        <div class="tools">
            <div class="colorPicker">
                <div class="colorPicker__HS"></div>
                <label>
                    Lightness
                    <input class="colorPicker__L" type="range" min="0" max="100" value="50"></div>
                </label>
            </div>
        </div>
    </section>
    <script>
        var body = document.querySelector("body");

        var canvas = document.querySelector(".canvas");
        var pixels = document.querySelectorAll(".pixel");
        var colorPicker = document.querySelector(".colorPicker__HS");
        var lightnessPicker = document.querySelector(".colorPicker__L");
        var drawing = false;
        var color = "yellow";


        pixels.forEach(function(pixel){
            pixel.addEventListener("mouseover", function(e){
                registerEvent(this, e);
            });
            pixel.addEventListener("mousedown", function(e){
                registerEvent(this, e);
            });
        });

        canvas.addEventListener("mousedown", function(){window.drawing = true;});
        body.addEventListener("mouseup", function(){window.drawing = false;});
        body.addEventListener("mouseleave", function(){window.drawing = false;});

        var registerEvent = function (pixel, e) {
            if(e.type === "mouseover"){
                if(window.drawing === true){
                    draw(pixel);
                }
            } else if(e.type === "mousedown") {
                draw(pixel);
            }
        };

        // colorSelect.addEventListener("change", function(){
        //     color = this.value;
        // });

        var draw = function(pixel) {
        	pixel.style.backgroundColor = color;
        };

        var buildColorPicker = function(light){
            var light = light || 50;
            var domStr = "";
            var hueConverter = 3.6;
            for(var row = 0; row<=99; row++){
                for(var col = 0; col<=99; col++){
                    var hue = col * hueConverter;
                    domStr += `<div style="background-color: hsl(` + hue + `,` + row + `%,` + light + `%);"></div>`;
                    //class="colorPicker__pixel" data-hue="` + hue + `" data-sat="` + row + `"
                }
            }
            colorPicker.innerHTML = domStr;
        };


        lightnessPicker.addEventListener("change", function(){
            buildColorPicker(this.value);
        });

        colorPicker.addEventListener("click", function(e){
                debugger;
        });

        buildColorPicker(50);

    </script>
</body>
</html>